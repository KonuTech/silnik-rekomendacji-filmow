DROP FUNCTION `DoMReleaseYear`;
CREATE DEFINER=`glebels_root`@`localhost` FUNCTION `DoMReleaseYear`(`idFilm1` INT, `idFilm2` INT) RETURNS DECIMAL(10,7) DETERMINISTIC NO SQL SQL SECURITY DEFINER return (select if((select Year(rok_produkcji) from Filmy where id_film = idFilm1)<(select Year(rok_produkcji) from Filmy where id_film = idFilm2), 
    (select ((select Year(rok_produkcji) from Filmy where id_film = idFilm1)+1-(select Year(rok_produkcji) from Filmy order by Year(rok_produkcji) asc limit 0,1))/((select Year(rok_produkcji) from Filmy where id_film = idFilm2)+1-(select Year(rok_produkcji) from Filmy order by Year(rok_produkcji) asc limit 0,1)) as DoM), 
    (select ((select Year(rok_produkcji) from Filmy order by Year(rok_produkcji) desc limit 0,1)+1-(select Year(rok_produkcji) from Filmy where id_film = idFilm1))/((select Year(rok_produkcji) from Filmy order by Year(rok_produkcji) desc limit 0,1)+1-(select Year(rok_produkcji) from Filmy where id_film = idFilm2)) as DoM)) as DoM)